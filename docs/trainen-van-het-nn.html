<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Hoofdstuk 6 Trainen van het NN | VR Experience (ML-agents)</title>
  <meta name="description" content="AI-augemnted virtual realitity course at the AP University College." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Hoofdstuk 6 Trainen van het NN | VR Experience (ML-agents)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="AI-augemnted virtual realitity course at the AP University College." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Hoofdstuk 6 Trainen van het NN | VR Experience (ML-agents)" />
  
  <meta name="twitter:description" content="AI-augemnted virtual realitity course at the AP University College." />
  

<meta name="author" content="34145/1928/2021/1/56 David D’Haese" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="testen-van-de-spellogica.html"/>
<link rel="next" href="testen-van-een-nn.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\course.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ML-Agents</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#language"><i class="fa fa-check"></i>Language</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="inleiding-tot-het-onderdeel-ml-agents.html"><a href="inleiding-tot-het-onderdeel-ml-agents.html"><i class="fa fa-check"></i><b>1</b> Inleiding tot het onderdeel ML-Agents</a><ul>
<li class="chapter" data-level="1.1" data-path="inleiding-tot-het-onderdeel-ml-agents.html"><a href="inleiding-tot-het-onderdeel-ml-agents.html#in-een-notedop"><i class="fa fa-check"></i><b>1.1</b> In een notedop</a></li>
<li class="chapter" data-level="1.2" data-path="inleiding-tot-het-onderdeel-ml-agents.html"><a href="inleiding-tot-het-onderdeel-ml-agents.html#leerdoelen"><i class="fa fa-check"></i><b>1.2</b> Leerdoelen</a></li>
<li class="chapter" data-level="1.3" data-path="inleiding-tot-het-onderdeel-ml-agents.html"><a href="inleiding-tot-het-onderdeel-ml-agents.html#cursus-vorm"><i class="fa fa-check"></i><b>1.3</b> Cursus vorm</a></li>
<li class="chapter" data-level="1.4" data-path="inleiding-tot-het-onderdeel-ml-agents.html"><a href="inleiding-tot-het-onderdeel-ml-agents.html#licentie-voor-deze-cursus"><i class="fa fa-check"></i><b>1.4</b> Licentie voor deze cursus</a></li>
<li class="chapter" data-level="1.5" data-path="inleiding-tot-het-onderdeel-ml-agents.html"><a href="inleiding-tot-het-onderdeel-ml-agents.html#verwijzen-naar-deze-cursus"><i class="fa fa-check"></i><b>1.5</b> Verwijzen naar deze cursus</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="beginselen-ml-agents.html"><a href="beginselen-ml-agents.html"><i class="fa fa-check"></i><b>2</b> Beginselen ML-Agents</a><ul>
<li class="chapter" data-level="2.1" data-path="beginselen-ml-agents.html"><a href="beginselen-ml-agents.html#vereiste-voorkennis-en-voorinstallatie"><i class="fa fa-check"></i><b>2.1</b> Vereiste voorkennis en voorinstallatie</a></li>
<li class="chapter" data-level="2.2" data-path="beginselen-ml-agents.html"><a href="beginselen-ml-agents.html#installatie"><i class="fa fa-check"></i><b>2.2</b> Installatie</a></li>
<li class="chapter" data-level="2.3" data-path="beginselen-ml-agents.html"><a href="beginselen-ml-agents.html#ml-agents-toolkit"><i class="fa fa-check"></i><b>2.3</b> ML-Agents Toolkit</a></li>
<li class="chapter" data-level="2.4" data-path="beginselen-ml-agents.html"><a href="beginselen-ml-agents.html#machine-learning-in-een-notedop"><i class="fa fa-check"></i><b>2.4</b> Machine learning in een notedop</a></li>
<li class="chapter" data-level="2.5" data-path="beginselen-ml-agents.html"><a href="beginselen-ml-agents.html#interactie-tussen-het-nn-en-de-unity-omgeving"><i class="fa fa-check"></i><b>2.5</b> Interactie tussen het NN en de Unity omgeving</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html"><i class="fa fa-check"></i><b>3</b> Obelix de menhirhouwer</a><ul>
<li class="chapter" data-level="3.1" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#inleiding-tot-de-usecase"><i class="fa fa-check"></i><b>3.1</b> Inleiding tot de usecase</a></li>
<li class="chapter" data-level="3.2" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#het-spelverloop"><i class="fa fa-check"></i><b>3.2</b> Het spelverloop</a></li>
<li class="chapter" data-level="3.3" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#observaties-acties-en-beloning"><i class="fa fa-check"></i><b>3.3</b> Observaties, acties en beloning</a></li>
<li class="chapter" data-level="3.4" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#het-speelveld"><i class="fa fa-check"></i><b>3.4</b> Het speelveld</a></li>
<li class="chapter" data-level="3.5" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#spelomgeving"><i class="fa fa-check"></i><b>3.5</b> Spelomgeving</a><ul>
<li class="chapter" data-level="3.5.1" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#speelveld-object"><i class="fa fa-check"></i><b>3.5.1</b> Speelveld object</a></li>
<li class="chapter" data-level="3.5.2" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#obelix-spelobject"><i class="fa fa-check"></i><b>3.5.2</b> Obelix spelobject</a></li>
<li class="chapter" data-level="3.5.3" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#de-menhir-en-de-bestemming"><i class="fa fa-check"></i><b>3.5.3</b> De menhir en de bestemming</a></li>
<li class="chapter" data-level="3.5.4" data-path="obelix-de-menhirhouwer.html"><a href="obelix-de-menhirhouwer.html#scorebord"><i class="fa fa-check"></i><b>3.5.4</b> Scorebord</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><i class="fa fa-check"></i><b>4</b> Gedragingen van de agent en de andere spelobjecten</a><ul>
<li class="chapter" data-level="4.1" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#environment.cs"><i class="fa fa-check"></i><b>4.1</b> Environment.cs</a><ul>
<li class="chapter" data-level="4.1.1" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#overzicht-methoden-op-environment"><i class="fa fa-check"></i><b>4.1.1</b> Overzicht methoden op Environment</a></li>
<li class="chapter" data-level="4.1.2" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#object-variabelen-op-environment"><i class="fa fa-check"></i><b>4.1.2</b> Object-variabelen op Environment</a></li>
<li class="chapter" data-level="4.1.3" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#initializatie-van-environment-instantie"><i class="fa fa-check"></i><b>4.1.3</b> Initializatie van Environment instantie</a></li>
<li class="chapter" data-level="4.1.4" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#opkuisen-speelveld"><i class="fa fa-check"></i><b>4.1.4</b> Opkuisen speelveld</a></li>
<li class="chapter" data-level="4.1.5" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#score"><i class="fa fa-check"></i><b>4.1.5</b> Score</a></li>
<li class="chapter" data-level="4.1.6" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#willekeurige-positie"><i class="fa fa-check"></i><b>4.1.6</b> Willekeurige positie</a></li>
<li class="chapter" data-level="4.1.7" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#genereren-van-een-stonehenge"><i class="fa fa-check"></i><b>4.1.7</b> Genereren van een Stonehenge</a></li>
<li class="chapter" data-level="4.1.8" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#dynamisch-genereren-van-menhirs"><i class="fa fa-check"></i><b>4.1.8</b> Dynamisch genereren van menhirs</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#destination.cs"><i class="fa fa-check"></i><b>4.2</b> Destination.cs</a></li>
<li class="chapter" data-level="4.3" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#obelix.cs"><i class="fa fa-check"></i><b>4.3</b> Obelix.cs</a><ul>
<li class="chapter" data-level="4.3.1" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#overzicht-methoden"><i class="fa fa-check"></i><b>4.3.1</b> Overzicht methoden</a></li>
<li class="chapter" data-level="4.3.2" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#objectvariabelen"><i class="fa fa-check"></i><b>4.3.2</b> Objectvariabelen</a></li>
<li class="chapter" data-level="4.3.3" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#initialize"><i class="fa fa-check"></i><b>4.3.3</b> Initialize</a></li>
<li class="chapter" data-level="4.3.4" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#onepisodebegin"><i class="fa fa-check"></i><b>4.3.4</b> OnEpisodeBegin</a></li>
<li class="chapter" data-level="4.3.5" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#collectobservations"><i class="fa fa-check"></i><b>4.3.5</b> CollectObservations</a></li>
<li class="chapter" data-level="4.3.6" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#heuristic"><i class="fa fa-check"></i><b>4.3.6</b> Heuristic</a></li>
<li class="chapter" data-level="4.3.7" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#onactionreceived"><i class="fa fa-check"></i><b>4.3.7</b> OnActionReceived</a></li>
<li class="chapter" data-level="4.3.8" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#oncollisionenter"><i class="fa fa-check"></i><b>4.3.8</b> OnCollisionEnter</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="gedragingen-van-de-agent-en-de-andere-spelobjecten.html"><a href="gedragingen-van-de-agent-en-de-andere-spelobjecten.html#menhir.cs"><i class="fa fa-check"></i><b>4.4</b> Menhir.cs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="testen-van-de-spellogica.html"><a href="testen-van-de-spellogica.html"><i class="fa fa-check"></i><b>5</b> Testen van de spellogica</a></li>
<li class="chapter" data-level="6" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html"><i class="fa fa-check"></i><b>6</b> Trainen van het NN</a><ul>
<li class="chapter" data-level="6.1" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html#configuratie-van-het-nn"><i class="fa fa-check"></i><b>6.1</b> Configuratie van het NN</a><ul>
<li class="chapter" data-level="6.1.1" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html#trainer-type"><i class="fa fa-check"></i><b>6.1.1</b> Trainer-type</a></li>
<li class="chapter" data-level="6.1.2" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html#hyperparameters"><i class="fa fa-check"></i><b>6.1.2</b> Hyperparameters</a></li>
<li class="chapter" data-level="6.1.3" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html#architectuur-van-het-nn"><i class="fa fa-check"></i><b>6.1.3</b> Architectuur van het NN</a></li>
<li class="chapter" data-level="6.1.4" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html#beloningsysteem"><i class="fa fa-check"></i><b>6.1.4</b> Beloningsysteem</a></li>
<li class="chapter" data-level="6.1.5" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html#extra-informatie-rond-configuratie"><i class="fa fa-check"></i><b>6.1.5</b> Extra informatie rond configuratie</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html#start-de-training"><i class="fa fa-check"></i><b>6.2</b> Start de training</a></li>
<li class="chapter" data-level="6.3" data-path="trainen-van-het-nn.html"><a href="trainen-van-het-nn.html#paralleliseren"><i class="fa fa-check"></i><b>6.3</b> Paralleliseren</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="testen-van-een-nn.html"><a href="testen-van-een-nn.html"><i class="fa fa-check"></i><b>7</b> Testen van een NN</a><ul>
<li class="chapter" data-level="7.1" data-path="testen-van-een-nn.html"><a href="testen-van-een-nn.html#het-nn-bestand"><i class="fa fa-check"></i><b>7.1</b> Het nn-bestand</a></li>
<li class="chapter" data-level="7.2" data-path="testen-van-een-nn.html"><a href="testen-van-een-nn.html#tensorboard"><i class="fa fa-check"></i><b>7.2</b> Tensorboard</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="zelf-een-eigen-intelligente-agent-creëren.html"><a href="zelf-een-eigen-intelligente-agent-creëren.html"><i class="fa fa-check"></i><b>8</b> Zelf een eigen intelligente agent creëren</a></li>
<li class="chapter" data-level="" data-path="bronvermelding.html"><a href="bronvermelding.html"><i class="fa fa-check"></i>Bronvermelding</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">VR Experience (ML-agents)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trainen-van-het-nn" class="section level1">
<h1><span class="header-section-number">Hoofdstuk 6</span> Trainen van het NN</h1>
<div id="configuratie-van-het-nn" class="section level2">
<h2><span class="header-section-number">6.1</span> Configuratie van het NN</h2>
<p>Configuratie van het NN en de Python-Unity interface gebeurt hier d.m.v. een yaml-bestand (cheatsheet <a href="https://lzone.de/cheat-sheet/YAML">hier</a>). Maak daarom een nieuw bestand aan met de naam <code>Obelix-01.yml</code>. We beginnen met aan te geven dat de configuratie geldt voor de Obelix agent:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a href="trainen-van-het-nn.html#cb20-1"></a><span class="fu">behaviors</span><span class="kw">:</span></span>
<span id="cb20-2"><a href="trainen-van-het-nn.html#cb20-2"></a><span class="at">  </span><span class="fu">Obelix</span><span class="kw">:</span></span></code></pre></div>
<p>Opgelet: De naam <code>Obelix</code> moet overeenkomen met de <em>Behavior Name</em>.</p>
<p>Je kan in het configuratiebestand meerdere <em>gedragingen</em> toevoegen, waarbij een gedrag overeenkomt met een type agent en met een NN.</p>
<div id="trainer-type" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Trainer-type</h3>
<p>De eerste configuratie-parameter is</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a href="trainen-van-het-nn.html#cb21-1"></a><span class="at">    </span><span class="fu">trainer_type</span><span class="kw">:</span><span class="at"> ppo</span></span></code></pre></div>
<p>Hiermee bepaal je het type conditioneringsalgoritme en meteen ook een groot aantal andere confirguratieparameters. De mogelijkheden zijn:</p>
<ul>
<li><code>ppo</code>: <em>Proximal Policy Optimization</em> Dit algoritme zal trachten niet te ver af te wijken van de vorige set van voorgestelde acties (eng: <em>policy</em>) door een vorm van regularisatie toe te passen</li>
<li><code>sac</code>: <em>Soft-Actor Critic</em> Dit is een zogenaamde <em>off-policy</em> algoritme dat uit zijn geheugen ervaringen uit het verleden kan ophalen. Het heeft minder cycli nodig om te leren en is beter geschikt voor meer complexe omgevingen.</li>
</ul>
</div>
<div id="hyperparameters" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Hyperparameters</h3>
<p>Hieronder de hyperparameters op het leeralgoritme:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb22-1"><a href="trainen-van-het-nn.html#cb22-1"></a><span class="at">    </span><span class="fu">max_steps</span><span class="kw">:</span><span class="at"> </span><span class="fl">5.0e5</span></span>
<span id="cb22-2"><a href="trainen-van-het-nn.html#cb22-2"></a><span class="at">    </span><span class="fu">time_horizon</span><span class="kw">:</span><span class="at"> </span><span class="dv">64</span></span>
<span id="cb22-3"><a href="trainen-van-het-nn.html#cb22-3"></a><span class="at">    </span><span class="fu">summary_freq</span><span class="kw">:</span><span class="at"> </span><span class="dv">10000</span></span>
<span id="cb22-4"><a href="trainen-van-het-nn.html#cb22-4"></a><span class="at">    </span><span class="fu">keep_checkpoints</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb22-5"><a href="trainen-van-het-nn.html#cb22-5"></a><span class="at">    </span><span class="fu">checkpoint_interval</span><span class="kw">:</span><span class="at"> </span><span class="dv">50000</span></span>
<span id="cb22-6"><a href="trainen-van-het-nn.html#cb22-6"></a><span class="at">    </span></span>
<span id="cb22-7"><a href="trainen-van-het-nn.html#cb22-7"></a><span class="at">    </span><span class="fu">hyperparameters</span><span class="kw">:</span></span>
<span id="cb22-8"><a href="trainen-van-het-nn.html#cb22-8"></a><span class="at">      </span><span class="fu">batch_size</span><span class="kw">:</span><span class="at"> </span><span class="dv">64</span></span>
<span id="cb22-9"><a href="trainen-van-het-nn.html#cb22-9"></a><span class="at">      </span><span class="fu">buffer_size</span><span class="kw">:</span><span class="at"> </span><span class="dv">9600</span></span>
<span id="cb22-10"><a href="trainen-van-het-nn.html#cb22-10"></a><span class="at">      </span><span class="fu">learning_rate</span><span class="kw">:</span><span class="at"> </span><span class="fl">3.0e-4</span></span>
<span id="cb22-11"><a href="trainen-van-het-nn.html#cb22-11"></a><span class="at">      </span><span class="fu">learning_rate_schedule</span><span class="kw">:</span><span class="at"> constant</span></span>
<span id="cb22-12"><a href="trainen-van-het-nn.html#cb22-12"></a><span class="at">      </span><span class="fu">beta</span><span class="kw">:</span><span class="at"> </span><span class="fl">5.0e-3</span></span>
<span id="cb22-13"><a href="trainen-van-het-nn.html#cb22-13"></a><span class="at">      </span><span class="fu">epsilon</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.2</span></span>
<span id="cb22-14"><a href="trainen-van-het-nn.html#cb22-14"></a><span class="at">      </span><span class="fu">lambd</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.95</span></span>
<span id="cb22-15"><a href="trainen-van-het-nn.html#cb22-15"></a><span class="at">      </span><span class="fu">num_epoch</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span></code></pre></div>
<ul>
<li><code>max_steps</code>: totaal maximum aantal stappen die de simulatie mag doorlopen gedurende de ganse trainingsfase</li>
<li><code>time_horizon</code>: aantal ervaringen samen te nemen alvorens deze naar de ervaringsbuffer te sturen. Een set van observaties samen met de status waarin de agent zich bevindt, dus een input-rij voor het NN, noemt men de ervaring (eng: <em>experience</em>).</li>
<li><code>summary_freq</code>: aantal ervaringen die worden samengenomen alvorens samenvattende statistieken ervan te berekenen (≈ resolutie in Tensorboard)</li>
<li><code>keep_checkpoints</code>: een checkpoint is een soort backup van het NN model</li>
<li><code>checkpoint_interval</code>: de frequentie waarmee de backups genomen moeten worden</li>
<li><code>batch_size</code> bepaalt de grootte van de <em>minibatch</em>. <code>batch_size</code> weerspiegelt het aantal ervaringen die worden samengenomen per optimalisatie-stap (gradiënt-afdaling, eng: <em>gradient descent</em>)</li>
<li><code>buffer_size</code> geeft het aantal ervaringen weer die worden samengenomen alvorens het leeralgoritme, in batches <code>batch_size</code> groot, de ervaringen verwerkt. Moet dus een meervoud van <code>batch_size</code> zijn</li>
<li><code>learning_rate</code> is de leersnelheid en bepaalt tijdens de optimalisatie de grootte van de stap die het leeralgoritme in de richting van de gradient neemt</li>
<li><code>learning_rate_schedule</code>: is de mate waarin de leersnelheid zich aanpast tijdens het leerproces. <code>constant</code> betekent dat de leersnelheid constant blijft en <code>linear</code> betekent dat de leersnelheid gelijkmatig afneemt naarmate het maximum aantal stappen (<code>max_steps</code>) nadert</li>
<li><code>beta</code> geeft weer hoe sterk het voorstel van een nieuw beleid wordt afgeremd en is een cruciaal onderdeel van de regularisatie van het beleid. Door middel van de entropie (Tensorboard) te volgen, kan men deze waarde bijsturen indien nodig. Daalt de entropie te snel t.o.v. een stijgende gemiddelde beloning → verhoog <code>beta</code>, daalt het te traag → verlaag <code>beta</code></li>
<li><code>epsilon</code> is gelijkaardig aan <code>beta</code> maar bepaalt het maximum waarmee een nieuw beleid mag verschillen van het vorig voorgesteld beleid</li>
<li><code>lambd</code> is nog een regularisatie-parameter die bepaalt hoe sterk de beloningen doorwegen tijdens het aanpassen van de gewichten van de connectoren van het NN</li>
<li><code>num_epoch</code> bepaalt het aantal NN epochs per Unity frame</li>
</ul>
</div>
<div id="architectuur-van-het-nn" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Architectuur van het NN</h3>
<p>Hieronder vind je de configuratie van de architectuur van het NN dat gekoppeld wordt met de Obelix agent:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb23-1"><a href="trainen-van-het-nn.html#cb23-1"></a><span class="at">    </span><span class="fu">network_settings</span><span class="kw">:</span></span>
<span id="cb23-2"><a href="trainen-van-het-nn.html#cb23-2"></a><span class="at">      </span><span class="fu">num_layers</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb23-3"><a href="trainen-van-het-nn.html#cb23-3"></a><span class="at">      </span><span class="fu">hidden_units</span><span class="kw">:</span><span class="at"> </span><span class="dv">128</span></span>
<span id="cb23-4"><a href="trainen-van-het-nn.html#cb23-4"></a><span class="at">      </span><span class="fu">normalize</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span></code></pre></div>
<ul>
<li><code>num_layers</code>: Het aantal verborgen lagen van het NN, dus exclusief de invoer en uitvoer laag</li>
<li><code>hidden_units</code>: Het aantal neuronen of nodes per verborgen laag in het NN. Samen met <code>num_layers</code> bepaalt dit de grootte van het artificieel brein.</li>
<li><code>normalize</code>: Moet eigenlijk <a href="https://en.wikipedia.org/wiki/Standard_score"><em>standardize</em></a> heten en kan belangrijk zijn wanneer men acties d.m.v. <a href="https://www.khanacademy.org/math/statistics-probability/random-variables-stats-library/random-variables-discrete/v/discrete-and-continuous-random-variables">continue variabelen</a> codeert.</li>
</ul>
<p>Als je aan je eigen agent gaat werken, moet je ook nadenken of er geheugen nodig is. Zo ja, dan kan je dit op deze manier coderen, binnen het onderdeel <code>network_settings</code> (zie <a href="trainen-van-het-nn.html#extra-informatie-rond-configuratie">hieronder</a> voor links naar online documentatie hierrond):</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a href="trainen-van-het-nn.html#cb24-1"></a><span class="at">      </span><span class="fu">memory</span><span class="kw">:</span></span>
<span id="cb24-2"><a href="trainen-van-het-nn.html#cb24-2"></a><span class="at">        </span><span class="fu">sequence_length</span><span class="kw">:</span><span class="at"> </span><span class="dv">64</span></span>
<span id="cb24-3"><a href="trainen-van-het-nn.html#cb24-3"></a><span class="at">        </span><span class="fu">memory_size</span><span class="kw">:</span><span class="at"> </span><span class="dv">256</span></span></code></pre></div>
</div>
<div id="beloningsysteem" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Beloningsysteem</h3>
<p>Het einddoel van het NN is om een beleid te vinden dat de beloning zo groot mogelijk maakt. De beloningen die in <code>Obelix.cs</code> bepaald werden, noemt men de extrinsieke beloningen (eng: <em>extrinsic rewards</em>) omdat ze door de Unity Agent en niet door het leeralgoritme zelf worden bepaald. Daarnaast kan men nog een aantal intrinsieke beloningen definiëren. Uiteindelijk zal het leeralgoritme een mix van extrinsieke en intrinsieke beloningen gebruiken.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb25-1"><a href="trainen-van-het-nn.html#cb25-1"></a><span class="at">    </span><span class="fu">reward_signals</span><span class="kw">:</span></span>
<span id="cb25-2"><a href="trainen-van-het-nn.html#cb25-2"></a><span class="at">      </span><span class="fu">extrinsic</span><span class="kw">:</span></span>
<span id="cb25-3"><a href="trainen-van-het-nn.html#cb25-3"></a><span class="at">        </span><span class="fu">strength</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.0</span></span>
<span id="cb25-4"><a href="trainen-van-het-nn.html#cb25-4"></a><span class="at">        </span><span class="fu">gamma</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.99</span></span>
<span id="cb25-5"><a href="trainen-van-het-nn.html#cb25-5"></a><span class="at">      </span><span class="fu">curiosity</span><span class="kw">:</span></span>
<span id="cb25-6"><a href="trainen-van-het-nn.html#cb25-6"></a><span class="at">        </span><span class="fu">strength</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.02</span></span>
<span id="cb25-7"><a href="trainen-van-het-nn.html#cb25-7"></a><span class="at">        </span><span class="fu">gamma</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.99</span></span>
<span id="cb25-8"><a href="trainen-van-het-nn.html#cb25-8"></a><span class="at">        </span><span class="fu">encoding_size</span><span class="kw">:</span><span class="at"> </span><span class="dv">256</span></span>
<span id="cb25-9"><a href="trainen-van-het-nn.html#cb25-9"></a><span class="at">        </span><span class="fu">learning_rate </span><span class="kw">:</span><span class="at"> </span><span class="fl">1e-3</span></span></code></pre></div>
<ul>
<li><code>curiosity</code> is zo een intrinsieke beloning die gebruikt kan worden indien de beloningen schaars zijn en indien de kans dus klein is om beloond te worden. Door deze waarde te verhogen, verhoog je ook de kans dat de agent ‘per ongeluk’ de juiste actie uitvoert.</li>
<li><code>strength</code> geeft een gewicht aan het specifiek type belonging</li>
<li><code>gamma</code> is een vermenigvuldigingsfactor die aangeeft in hoeverre de agent moet anticiperen op toekomstige beloningen van dit type</li>
<li><code>encoding_size</code>: (optioneel) grootte van het intrinsiek model</li>
<li><code>learning_rate</code>: (optioneel) snelheid waarmee de <code>strength</code> mag afnemen</li>
</ul>
</div>
<div id="extra-informatie-rond-configuratie" class="section level3">
<h3><span class="header-section-number">6.1.5</span> Extra informatie rond configuratie</h3>
<blockquote>
<p>Meer informatie rond de configuratie van agents vind je <a href="https://github.com/Unity-Technologies/ml-agents/blob/release_6_docs/docs/Training-Configuration-File.md">hier</a> en <a href="https://gitee.com/mirrors/Unity-ML-Agents/blob/2a06b63ba73b8c18aae1d213a74280d7f0a8a298/docs/Training-PPO.md">hier</a>.</p>
</blockquote>
<blockquote>
<p>Je kan <em>Environment Parameters</em> definiëren in de root van jouw configuratiebestand die je dan vanuit C# kan aanspreken (zie <a href="https://github.com/Unity-Technologies/ml-agents/blob/release_6_docs/docs/Training-ML-Agents.md#environment-parameters">hier</a>)</p>
</blockquote>
<blockquote>
<p>Informatie rond <a href="https://spinningup.openai.com/en/latest/user/algorithms.html#the-on-policy-algorithms">algoritme families</a></p>
</blockquote>
</div>
</div>
<div id="start-de-training" class="section level2">
<h2><span class="header-section-number">6.2</span> Start de training</h2>
<p>Hier is een stappenplan voor het starten van de training:</p>
<ol style="list-style-type: decimal">
<li><p>Controleer de instellingen nog eens:</p>
<p><img src="img/controle_training.png" /></p></li>
<li><p>Zorg dat het Unity project open is en zorg ervoor dat de <em>Behavior Type</em> in de <em>Behavior Parameters</em>-component op <em>Default</em> staat.</p></li>
<li><p>Navigeer naar de folder van je Unity project en maak daarin een sub-folder <em>Learning</em></p></li>
<li><p>Kopieer het yaml configuratiebestand in deze folder</p></li>
<li><p>Open een console van je OS in deze sub-folder</p></li>
<li><p>Indien van toepassing, activeer dan de gepaste Python omgeving</p></li>
<li><p>Voer de Python <code>mlagents-learn</code> functie uit met als parameters de naam van het configuratiebestand en een naam voor de uitvoering (eng: <em>run</em>):</p>
<pre class="cmd"><code>mlagents-learn Obelix-01.yml --run-id Obelix-01</code></pre>
<p>Krijg je het Unity logo te zien, dan zit het meestal goed. Anders moet je de foutmeldingen lezen en indien nodig opzoeken.</p>
<pre><code>                        ▄▄▄▓▓▓▓
                ╓▓▓▓▓▓▓█▓▓▓▓▓
           ,▄▄▄m▀▀▀&#39;  ,▓▓▓▀▓▓▄                           ▓▓▓  ▓▓▌
         ▄▓▓▓▀&#39;      ▄▓▓▀  ▓▓▓      ▄▄     ▄▄ ,▄▄ ▄▄▄▄   ,▄▄ ▄▓▓▌▄ ▄▄▄    ,▄▄
       ▄▓▓▓▀        ▄▓▓▀   ▐▓▓▌     ▓▓▌   ▐▓▓ ▐▓▓▓▀▀▀▓▓▌ ▓▓▓ ▀▓▓▌▀ ^▓▓▌  ╒▓▓▌
     ▄▓▓▓▓▓▄▄▄▄▄▄▄▄▓▓▓      ▓▀      ▓▓▌   ▐▓▓ ▐▓▓    ▓▓▓ ▓▓▓  ▓▓▌   ▐▓▓▄ ▓▓▌
     ▀▓▓▓▓▀▀▀▀▀▀▀▀▀▀▓▓▄     ▓▓      ▓▓▌   ▐▓▓ ▐▓▓    ▓▓▓ ▓▓▓  ▓▓▌    ▐▓▓▐▓▓
       ^█▓▓▓        ▀▓▓▄   ▐▓▓▌     ▓▓▓▓▄▓▓▓▓ ▐▓▓    ▓▓▓ ▓▓▓  ▓▓▓▄    ▓▓▓▓`
         &#39;▀▓▓▓▄      ^▓▓▓  ▓▓▓       └▀▀▀▀ ▀▀ ^▀▀    `▀▀ `▀▀   &#39;▀▀    ▐▓▓▌
            ▀▀▀▀▓▄▄▄   ▓▓▓▓▓▓,                                      ▓▓▓▓▀
                `▀█▓▓▓▓▓▓▓▓▓▌
                     ¬`▀▀▀█▓</code></pre></li>
<li><p>Je krijgt dan slechts enkele seconden om binnen de Unity GUI de ►-toets in te drukken</p></li>
</ol>
<blockquote>
<p>Je kan alternatief ook werken met <a href="https://github.com/Unity-Technologies/ml-agents/blob/release_6_docs/docs/Learning-Environment-Executable.md">Unity Executables</a>.</p>
</blockquote>
<blockquote>
<p>Je kan een stopgezette training hervatten met de <code>--resume</code> parameter van <code>mlagents-learn</code></p>
</blockquote>
<blockquote>
<p>Voor hulp: <code>mlagents-learn --help</code></p>
</blockquote>
<p>De training loopt zolang <code>max_steps</code> in het configuratiebestand niet bereikt is, maar je kan de training vroeger stoppen als je wil. Je stopt de training door nogmaals de ►-toets in te drukken. Tijdens de trainingsfase kan je het verloop van de gemiddelde geaccumuleerde beloning per episode volgen door middel van <em>Tensorboard</em>. Dit is het dashboard van TensorFlow dat als lokale server op jouw machine draait. Je kan Tensorboard starten dezelfde sub-folder (<code>Learning</code>):</p>
<pre class="cmd"><code>tensorboard --logdir results</code></pre>
<p>In je browser ga je dan naar <code>http://localhost:6006</code> en je zou het dashboard moeten zien verschijnen. Zie § <a href="testen-van-een-nn.html#tensorboard">Tensorboard</a> voor meer informatie.</p>
</div>
<div id="paralleliseren" class="section level2">
<h2><span class="header-section-number">6.3</span> Paralleliseren</h2>
<p>Om de trainingsfase te verkorten, kan je de omgevingen dupliceren. De agents binnen de gedupliceerde omgevingen moeten allen gekoppeld zijn met hetzelfde NN via eenzelfde <em>Behavior Name</em> eigenschap in de <em>Behavior Parameters</em> component.</p>
<div class="figure"><span id="fig:parallel-envs"></span>
<img src="img/parallel-envs.png" alt="Meerdere gedupliceerde omgevingen om de training te bespoedigen." width="640" />
<p class="caption">
Figuur 6.1: Meerdere gedupliceerde omgevingen om de training te bespoedigen.
</p>
</div>


</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="testen-van-de-spellogica.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="testen-van-een-nn.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ddhaese/vr-experience/06_Trainen_NN.Rmd",
"text": "Bron"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
